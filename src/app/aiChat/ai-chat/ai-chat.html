<div class="flex flex-column h-full">

  <!-- SCROLLABLE CHAT AREA -->
  <div #scrollMe class="flex-1 overflow-auto p-4 surface-ground">

    <div *ngFor="let msg of messages" class="mb-3">

      <!-- USER MESSAGE (RIGHT) -->
      <div *ngIf="msg.role === 'user'" class="flex justify-content-end">
        <div class="flex align-items-start gap-2 max-w-30rem">

          <div class="p-3 border-round bg-primary text-white shadow-2">
            {{ msg.text }}
          </div>

          <p-avatar label="RS" shape="circle"></p-avatar>

        </div>
      </div>

      <!-- AI MESSAGE (LEFT) -->
      <div *ngIf="msg.role === 'ai'" class="flex justify-content-start">
        <div class="flex align-items-start gap-2 max-w-30rem">

          <p-avatar icon="pi pi-bolt" shape="circle"></p-avatar>

          <div class="p-3 border-round surface-card shadow-1">
            {{ msg.text }}
          </div>

        </div>
      </div>

    </div>

    <!-- Typing Indicator -->
    <div *ngIf="loading" class="flex align-items-center gap-2 mt-2">
      <p-progressSpinner styleClass="w-2rem h-2rem"></p-progressSpinner>
      <span>AI is thinking...</span>
    </div>

  </div>

  <!-- FIXED BOTTOM INPUT BAR -->
  <div class="surface-card border-top-1 p-3" style="position: fixed; bottom: 100px; width: 100%;">

    <div class="flex gap-2 align-items-center">

      <input
        pInputText
        [(ngModel)]="message"
        (keyup.enter)="send()"
        placeholder="Type your message..."
        class="flex-1" />

      <button
        pButton
        icon="pi pi-send"
        (click)="send()"
        [disabled]="loading">
      </button>

    </div>

  </div>

</div>