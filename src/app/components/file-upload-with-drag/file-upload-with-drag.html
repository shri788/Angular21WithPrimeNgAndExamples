<p-toast></p-toast>

<div class="flex align-items-center justify-content-center min-h-screen surface-ground">

    <p-card styleClass="w-11 sm:w-40rem shadow-3 border-round-xl">

        <!-- Header -->
        <div class="text-center mb-4">
            <h2 class="m-0">Upload Files</h2>
            <small class="text-600">Drag & Drop or Click to Upload</small>
        </div>

        <!-- File Upload -->
        <p-fileUpload #fu mode="advanced" name="files" [multiple]="true" accept=".jpg,.png,.pdf,.mp4,.doc,.docx,.zip"
            [maxFileSize]="10000000" (onSelect)="onSelect($event)" (uploadHandler)="uploadFiles($event)"
            [showUploadButton]="false" [showCancelButton]="false" class="w-full">

            <ng-template pTemplate="content">
                <div class="flex flex-column align-items-center justify-content-center p-5 border-2 border-dashed border-300 border-round cursor-pointer hover:border-primary"
                    (click)="fu.choose()">

                    <i class="pi pi-cloud-upload text-5xl text-primary mb-3"></i>
                    <div class="text-lg font-semibold">Drop files here</div>
                    <small class="text-500">or click to browse</small>
                </div>
            </ng-template>

        </p-fileUpload>

        <!-- Selected Files (from TS state) -->
        @if (selectedFiles.length > 0) {

        <div class="mt-4 flex flex-column gap-2">

            @for (file of selectedFiles; track file.name) {

            <div class="flex align-items-center justify-content-between p-2 border-1 border-200 border-round">

                <div class="flex align-items-center gap-3 overflow-hidden">

                    <!-- IMAGE PREVIEW -->
                    @if (file.type.startsWith('image/') && file.objectURL) {
                    <img [src]="file.objectURL" width="40" height="40" class="border-round" style="object-fit:cover;">
                    }
                    @else {
                    <i class="pi pi-file text-2xl text-primary"></i>
                    }

                    <!-- File Name -->
                    <span class="white-space-nowrap overflow-hidden text-overflow-ellipsis">
                        {{ file.name }}
                    </span>

                </div>

                <!-- Remove -->
                <button pButton icon="pi pi-times" class="p-button-text p-button-danger" (click)="removeFile(file)">
                </button>

            </div>

            }

        </div>

        }

        <!-- Progress -->
        @if (uploading) {
        <div class="mt-3">
            <p-progressBar [value]="uploadProgress"></p-progressBar>
            <small class="text-600">{{ uploadProgress }}% uploaded</small>
        </div>
        }

    </p-card>
</div>